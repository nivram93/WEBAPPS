<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WEBAPPS | Welcome</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <script src="js/vendor/modernizr.js"></script>
	<style>
		#content {
			display: none;
		}
		
		.tiny.button.hidden.post {
			float: right;
			margin-top: -45px;
		}
		
		.commentmessage {
			margin-bottom: 20px;
		}
	</style>
	
	<script>
		
		function addCommentToComment(id) {
			var content = document.getElementById(id);
			
			var input = document.createElement("textarea");
			input.class = "expand";
			input.placeholder = "Reply...";
			input.id = id + "rep";
			input.setAttribute("onfocus", "expand('" + id + "rep');");
			input.setAttribute("onblur", "collapse('" + id + "rep');");
			
			var btn = document.createElement("input");
			btn.type = "text";
			
			content.appendChild(input);
			
		}
		
		function addComment(content_id, message_id) {
			var content = document.getElementById(content_id);
			content.style.display="block";
			var message_input = document.getElementById(message_id);
			var i = 0;
			var added = false;
			
			while(!added)
			{
				if(!document.getElementById('card' + i))
				{
					var card_message = document.createElement("div");
					card_message.setAttribute("class","commentmessage");
					card_message.innerHTML = message_input.value;
					message_input.value = "";
					
					var btn = document.createElement("input");
					btn.id = "reply" + i;
					btn.type = "button";
					btn.value = "Reply";
					btn.setAttribute("class", "tiny button hidden post");
					btn.onclick = function() {
						if(!document.getElementById("card" + (i - 1) + "rep"))
							addCommentToComment("card" + (i - 1));
						else if(document.getElementById("card" + (i - 1) + "rep").style.display == "none") {
							document.getElementById("card" + (i - 1) + "rep").style.display = "block";
						} else {
							var input = document.getElementById("card" + (i - 1) + "rep");
							if(input.value != "")
								addComment("card" + (i - 1), "card" + (i - 1) + "rep");
							input.innerHTML = "";
							input.style.display = "none";
						}
					};
					
					var ele = document.createElement("div");
					ele.setAttribute("id","card" + i);
					ele.setAttribute("class","panel");
					ele.appendChild(card_message);
					ele.appendChild(btn);
					
					content.appendChild(ele);
					
					added = true;
				}
				i++;
			}
		}
		
		function expand(id) {
			$('#' + id).animate({'height':"+=50px"}, 400);
			//$('a.tiny.button.hidden').css({'display': 'inline-block'});
			
		}
		
		function collapse(id) {
			$('#' + id).animate({'height':"-=50px"}, 400);
			//$('a.tiny.button.hidden').css({'display': 'none'});
		}
	</script>
  </head>
  <body>
    
    <div class="row">
      <div class="large-12 columns">
        <h1>Welcome to Teacher's Desk</h1>
      </div>
    </div>
    
    <div class="row">
		<div class="large-12 columns">

			<form>
				<div class="row">
					<div class="large-8 columns">
						<div class="panel" style = "background-color: rgb(202, 210, 204);");>
							<label>CARD GOES HERE</label>
						</div>
						
						<div class="panel" style = "background-color: rgb(202, 210, 204);"); >
							<label>Write a comment:</label>
							<textarea id="commentinput" class="expand" rows="1" cols="50" onfocus="expand('commentinput');" onblur="collapse('commentinput');" placeholder="Comment..." style="resize:none;"/></textarea>
							<a href="#" class="tiny button hidden" onclick="addComment('content', 'commentinput');">Post</a>
						</div>
						
						<div class="panel" id="content" style = "background-color: rgb(202, 210, 204);">
							Comments:
						</div>
					</div>
				</div>
			</form>
		</div>
    </div>
    
    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
    </script>
  </body>
</html>
